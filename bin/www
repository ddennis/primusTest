#!/usr/bin/env node

var app = require('../app');
var debug = require('debug')('PrimusTesting:server');
var http = require('http');
var primusSetup = require('../primusSetup');
var redis = require('redis');

var redisClient = redis.createClient("9536", "soapfish.redistogo.com");
redisClient.auth("dde25f9c3ce0ff7f2617753881dc54f5", function() {
  console.log("Connected TO REDIS");
  runServer();
});


function runServer () {

  var port = process.argv[2] || 3000;
  console.log (" www > using port = " , port);
  app.set('port', port);

  var server = http.createServer(app);
  server.listen(port);

  primusSetup.init(server, redisClient, port)

};

